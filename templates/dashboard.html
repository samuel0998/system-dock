{% extends "base.html" %}

{% block content %}

<div class="container">

    <!-- ========================= -->
    <!-- üîπ T√çTULO -->
    <!-- ========================= -->
    <div style="display:flex; align-items:center; gap:15px;">
        <h2 class="titulo-pagina">Dashboard DOCA</h2>
        <button onclick="toggleDarkMode()">üåô</button>
    </div>

    <!-- ========================= -->
    <!-- üîπ FILTRO -->
    <!-- ========================= -->
    <div class="filtro-container">
        <div class="filtro-grupo">
            <label>Buscar por Intervalo de Datas</label>
            <div style="display:flex; gap:10px; align-items:center;">
                <input type="date" id="dataInicio">
                <span>at√©</span>
                <input type="date" id="dataFim">
                <button onclick="aplicarFiltro()">Buscar</button>
            </div>
        </div>
    </div>

    <!-- ========================= -->
    <!-- üîπ CARDS -->
    <!-- ========================= -->
    <div class="cards-container">

        <div class="card-dashboard card-units">
            <div class="card-head"><h4>Total Units Fechadas</h4><span class="card-icon">üì¶</span></div>
            <span id="totalUnits">0</span>
            <p>Volume conclu√≠do no per√≠odo</p>
        </div>

        <div class="card-dashboard card-fechadas">
            <div class="card-head"><h4>Notas Fechadas</h4><span class="card-icon">‚úÖ</span></div>
            <span id="totalNotasFechadas">0</span>
            <p>Cargas finalizadas</p>
        </div>

        <div class="card-dashboard card-pendentes">
            <div class="card-head"><h4>Notas Pendentes</h4><span class="card-icon">üïí</span></div>
            <span id="totalNotasPendentes">0</span>
            <p>Em status arrival</p>
        </div>

        <div class="card-dashboard card-andamento">
            <div class="card-head"><h4>Notas em Andamento</h4><span class="card-icon">‚öôÔ∏è</span></div>
            <span id="totalNotasAndamento">0</span>
            <p>Com operador em checkin</p>
        </div>

        <div class="card-dashboard card-deletadas">
            <div class="card-head"><h4>Notas Deletadas</h4><span class="card-icon">üóëÔ∏è</span></div>
            <span id="totalNotasDeletadas">0</span>
            <p>Removidas no per√≠odo</p>
        </div>

        <div class="card-dashboard card-noshow">
            <div class="card-head"><h4>Notas No Show</h4><span class="card-icon">üö´</span></div>
            <span id="totalNotasNoShow">0</span>
            <p>Agendamentos n√£o comparecidos</p>
        </div>

        <div class="card-dashboard card-atrasadas">
            <div class="card-head"><h4>Cargas em Atraso (+4h)</h4><span class="card-icon">‚è∞</span></div>
            <span id="totalCargasAtrasadas">0</span>
            <p>SLA estourado no per√≠odo</p>
        </div>

    </div>

    <div class="dashboard-lista-atraso">
        <div class="dashboard-lista-header">
            <h4>Lista de Cargas em Atraso</h4>
            <small>Somente cargas com SLA de +4h ultrapassado</small>
            <input type="text" id="filtroAtrasoAppointment" placeholder="Filtrar Appointment ID" class="input-filtro-dashboard">
        </div>
        <div class="dashboard-lista-wrap">
            <table class="tabela-cargas-atrasadas">
                <thead>
                    <tr>
                        <th>Appointment ID</th>
                        <th>Status</th>
                        <th>Expected Arrival</th>
                        <th>Atraso</th>
                        <th>Units</th>
                        <th>Cartons</th>
                        <th>AA</th>
                        <th>Coment√°rio</th>
                    </tr>
                </thead>
                <tbody id="listaCargasAtrasadas"></tbody>
            </table>
        </div>
    </div>


    <div class="dashboard-lista-atraso">
        <div class="dashboard-lista-header">
            <h4>Produtividade por AA</h4>
            <small>Units, horas produzidas e rate (units/h)</small>
            <input type="text" id="filtroProdLogin" placeholder="Filtrar login" class="input-filtro-dashboard">
        </div>
        <div class="dashboard-lista-wrap">
            <table class="tabela-cargas-atrasadas">
                <thead>
                    <tr>
                        <th>Login</th>
                        <th>Units</th>
                        <th>Horas Produzidas</th>
                        <th>Rate (units/h)</th>
                    </tr>
                </thead>
                <tbody id="tabelaProdutividadeAA"></tbody>
            </table>
        </div>
    </div>

    <!-- ========================= -->
    <!-- üî• GR√ÅFICOS PRINCIPAIS -->
    <!-- ========================= -->
    <div class="graficos-grid">

        <div class="grafico-card">
            <h4>Unidades Recebidas por Dia</h4>
            <canvas id="graficoUnidadesDia"></canvas>
        </div>

        <div class="grafico-card">
            <h4>Notas Recebidas por Dia</h4>
            <canvas id="graficoNotasDia"></canvas>
        </div>

        <div class="grafico-card">
            <h4>Notas Deletadas por Dia</h4>
            <canvas id="graficoNotasDeletadasDia"></canvas>
        </div>
        
         <div class="grafico-card">
        <h4>No Show por Dia</h4>
        <canvas id="graficoNoShowDia"></canvas>
        </div>


        <div class="grafico-card" style="margin-top:40px;">
        <h4>Cargas Fechadas por AA</h4>
        <canvas id="graficoCargasPorLogin"></canvas>
        </div>


        <div class="grafico-card" style="margin-top:40px;">
        <h4>Performance por Login</h4>
        <canvas id="graficoPorLogin"></canvas>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>

{% endblock %}
